<div class="container">
    <div class="header-actions">
        <h2>Nuestros Productos F1</h2>
        <a href="/carts/6893def890c787ca530f7d3b" class="btn-view-cart">
            <i class="fas fa-shopping-cart"></i> Ver Carrito
        </a>
    </div>
    
    <div class="filters">
        <form method="GET" action="/" class="filter-form">
            <select name="query" onchange="this.form.submit()">
                <option value="">Todas las categorías</option>
                <option value="Monoplazas" {{#if (eq query "Monoplazas")}}selected{{/if}}>Monoplazas</option>
                <option value="Pilotos" {{#if (eq query "Pilotos")}}selected{{/if}}>Pilotos</option>
                <option value="Circuitos" {{#if (eq query "Circuitos")}}selected{{/if}}>Circuitos</option>
            </select>
            
            <select name="sort" onchange="this.form.submit()">
                <option value="">Sin ordenar</option>
                <option value="asc" {{#if (eq sort "asc")}}selected{{/if}}>Precio: Menor a Mayor</option>
                <option value="desc" {{#if (eq sort "desc")}}selected{{/if}}>Precio: Mayor a Menor</option>
            </select>
        </form>
    </div>
    
    <div class="products-grid">
        {{#each products}}
        <div class="product-card">
            {{#if imageUrl}}
            <img src="{{imageUrl}}" alt="{{title}}" loading="lazy" class="product-image" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
            {{/if}}
            {{#unless imageUrl}}
            <div class="product-placeholder"><i class="fas fa-image"></i></div>
            {{/unless}}
            <div class="product-placeholder" style="display: none;"></div>
            
            <h3>{{title}}</h3>
            <p>{{description}}</p>
            <p><strong>Precio:</strong> ${{price}}</p>
            <p><strong>Categoría:</strong> {{category}}</p>
            <p><strong>Estado:</strong> {{#if status}} Disponible {{else}} No disponible {{/if}}</p>
            
            <div class="product-actions">
                <a href="/products/{{_id}}" class="btn-view-details">Ver Detalles</a>
                {{#if status}}
                <button onclick="addToCart('{{_id}}')" class="btn-add-cart">Agregar al Carrito</button>
                {{/if}}
            </div>
        </div>
        {{/each}}
    </div>
    
    {{#if pagination}}
    <div class="pagination">
        {{#if pagination.hasPrevPage}}
        <a href="{{pagination.prevLink}}" class="btn-page">Anterior</a>
        {{/if}}
        
        <span class="page-info">
            Página {{pagination.page}} de {{pagination.totalPages}}
        </span>
        
        {{#if pagination.hasNextPage}}
        <a href="{{pagination.nextLink}}" class="btn-page">Siguiente</a>
        {{/if}}
    </div>
    {{/if}}
</div>

<!-- Incluir archivo JavaScript de acciones de productos -->
<script src="/js/productActions.js"></script>